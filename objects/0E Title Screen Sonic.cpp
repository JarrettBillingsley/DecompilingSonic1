// =====================================================================================================================
// Object 0E - Sonic on the title screen
// The big animated Sonic on the title screen, that's it.
// =====================================================================================================================

enum : ubyte
{
	Routine_Init = 0,
	Routine_Delay = 2,
	Routine_Move = 4,
	Routine_Animate = 6,
};

enum : ushort
{
	GFX_TitleSonic = 0x2300,

	TitleSonic_ScreenX = 128 + 112,
	TitleSonic_ScreenY = 128 + 94,
};

const ubyte Ani_TitleSonic[][] =
{
	{ 7, 0, 1, 2, 3, 4, 5, 6, 7, AnimFlags_Back, 2 },
};

const ubyte Map_TitleSonic[][] =
{
	{10, 8, 8, 0, 0, 8,
		0x10, 0xF, 0, 3, 8,
		0x10, 0xF, 0, 0x13, 0x28,
		0x30, 0xE, 0, 0x23, 8,
		0x30, 0xE, 0, 0x2F, 0x28,
		0x48, 0xD, 0, 0x3B, 0,
		0x48, 9, 0, 0x43, 0x20,
		0x48, 0, 0, 0x49, 0x38,
		0x58, 0xC, 0, 0x4A, 8,
		0x58, 0, 0, 0x4E, 0x28},
	{15, 0x48, 0xE, 1, 0xBD, 0x20,
		0x38, 5, 1, 0xC9, 0x38,
		0x40, 0, 1, 0xCD, 0x30,
		0x48, 0, 1, 0xCE, 0x40,
		0x60, 0, 1, 0xCF, 0x20,
		0x10, 0xE, 0, 0x4F, 8,
		0x10, 0xE, 0, 0x5B, 0x28,
		0x18, 1, 0, 0x67, 0x48,
		0x28, 2, 0, 0x69, 0,
		0x28, 0xF, 0, 0x6C, 8,
		0x28, 0xF, 0, 0x7C, 0x28,
		0x30, 2, 0, 0x8C, 0x48,
		0x48, 0xE, 0, 0x8F, 0x10,
		0x48, 9, 0, 0x9B, 0x30,
		0x58, 4, 0, 0xA1, 0x30},
	{17, 0x38, 0xE, 1, 0xBD, 0x28,
		0x28, 5, 1, 0xC9, 0x40,
		0x30, 0, 1, 0xCD, 0x38,
		0x38, 0, 1, 0xCE, 0x48,
		0x50, 0, 1, 0xCF, 0x28,
		0x20, 0xF, 1, 0xA9, 8,
		0x20, 3, 1, 0xB9, 0x28,
		0x10, 0xE, 0, 0x4F, 8,
		0x10, 0xE, 0, 0x5B, 0x28,
		0x18, 1, 0, 0x67, 0x48,
		0x28, 2, 0, 0x69, 0,
		0x28, 0xF, 0, 0x6C, 8,
		0x28, 0xF, 0, 0x7C, 0x28,
		0x30, 2, 0, 0x8C, 0x48,
		0x48, 0xE, 0, 0x8F, 0x10,
		0x48, 9, 0, 0x9B, 0x30,
		0x58, 4, 0, 0xA1, 0x30},
	{13, 0x10, 0xF, 0, 0xA3, 8,
		8, 8, 0, 0xB3, 0x28,
		0x10, 0xF, 0, 0xB6, 0x28,
		0x18, 0, 0, 0xC6, 0x48,
		0x20, 6, 0, 0xC7, 0x48,
		0x38, 0, 0, 0xCD, 0x48,
		0x30, 0xD, 0, 0xCE, 8,
		0x30, 0xE, 0, 0xD6, 0x28,
		0x40, 0xB, 0, 0xE2, 0x10,
		0x48, 8, 0, 0xEE, 0x28,
		0x50, 1, 0, 0xF1, 8,
		0x50, 4, 0, 0xF3, 0x28,
		0x58, 0, 0, 0xF5, 0x28},
	{11, 8, 0xF, 0, 0xF6, 0x10,
		8, 0xB, 1, 6, 0x30,
		0x10, 6, 1, 0x12, 0x48,
		0x28, 0xE, 1, 0x18, 0x18,
		0x28, 0xE, 1, 0x24, 0x38,
		0x28, 1, 1, 0x30, 0x10,
		0x40, 0xE, 1, 0x32, 0x10,
		0x40, 6, 1, 0x3E, 0x30,
		0x40, 4, 1, 0x44, 0x40,
		0x48, 0, 1, 0x46, 0x40,
		0x58, 8, 1, 0x47, 0x18},
	{19, 0x28, 0xE, 1, 0xE4, 0x38,
		0x18, 5, 1, 0xF0, 0x48,
		0x40, 8, 1, 0xF4, 0x38,
		0x48, 4, 1, 0xF7, 0x38,
		0x10, 0xF, 1, 0x4A, 0x10,
		8, 4, 1, 0x5A, 0x20,
		0, 0xB, 1, 0x5C, 0x30,
		8, 0, 1, 0x68, 0x48,
		0x18, 0, 1, 0x69, 0x48,
		0x18, 5, 1, 0x6A, 0,
		0x28, 2, 1, 0x6E, 8,
		0x30, 0xF, 1, 0x71, 0x10,
		0x20, 0xD, 1, 0x81, 0x30,
		0x20, 1, 1, 0x89, 0x50,
		0x30, 8, 1, 0x8B, 0x30,
		0x38, 0xE, 1, 0x8E, 0x30,
		0x50, 0xD, 1, 0x9A, 8,
		0x50, 0xC, 1, 0xA2, 0x28,
		0x58, 8, 1, 0xA6, 0x28},
	{21, 0x28, 0xE, 1, 0xE4, 0x38,
		0x18, 5, 1, 0xF0, 0x48,
		0x40, 8, 1, 0xF4, 0x38,
		0x48, 4, 1, 0xF7, 0x38,
		0x18, 0xF, 1, 0xD0, 8,
		0x18, 3, 1, 0xE0, 0x28,
		0x10, 0xF, 1, 0x4A, 0x10,
		8, 4, 1, 0x5A, 0x20,
		0, 0xB, 1, 0x5C, 0x30,
		8, 0, 1, 0x68, 0x48,
		0x18, 0, 1, 0x69, 0x48,
		0x18, 5, 1, 0x6A, 0,
		0x28, 2, 1, 0x6E, 8,
		0x30, 0xF, 1, 0x71, 0x10,
		0x20, 0xD, 1, 0x81, 0x30,
		0x20, 1, 1, 0x89, 0x50,
		0x30, 8, 1, 0x8B, 0x30,
		0x38, 0xE, 1, 0x8E, 0x30,
		0x50, 0xD, 1, 0x9A, 8,
		0x50, 0xC, 1, 0xA2, 0x28,
		0x58, 8, 1, 0xA6, 0x28},
	{22, 0x18, 4, 1, 0xF9, 0x38,
		0x20, 0, 1, 0xFB, 0x38,
		0x28, 8, 1, 0xFC, 0x30,
		0x30, 1, 1, 0xFF, 0x30,
		0x30, 0xB, 2, 1, 0x38,
		0x18, 0xF, 1, 0xD0, 8,
		0x18, 3, 1, 0xE0, 0x28,
		0x10, 0xF, 1, 0x4A, 0x10,
		8, 4, 1, 0x5A, 0x20,
		0, 0xB, 1, 0x5C, 0x30,
		8, 0, 1, 0x68, 0x48,
		0x18, 0, 1, 0x69, 0x48,
		0x18, 5, 1, 0x6A, 0,
		0x28, 2, 1, 0x6E, 8,
		0x30, 0xF, 1, 0x71, 0x10,
		0x20, 0xD, 1, 0x81, 0x30,
		0x20, 1, 1, 0x89, 0x50,
		0x30, 8, 1, 0x8B, 0x30,
		0x38, 0xE, 1, 0x8E, 0x30,
		0x50, 0xD, 1, 0x9A, 8,
		0x50, 0xC, 1, 0xA2, 0x28,
		0x58, 8, 1, 0xA6, 0x28}
};

void TitleSonic(Object* self)
{
	switch(self->routine)
	{
		case Routine_Init:
			self->routine = Routine_Delay;
			self->x = TitleSonic_ScreenX;
			self->screenY = TitleSonic_ScreenY;
			self->map = Map_TitleSonic;
			self->gfx = GFX_TitleSonic;
			self->priority = 1;
			self->delayAni = 29;
			AnimateSprite(self, Ani_TitleSonic);
			// fall through
		case Routine_Delay:
			if(TimerNeg(self->delayAni))
			{
				self->routine = Routine_Move;
				DisplaySprite(self);
			}
			break;

		case Routine_Move:
			self->obScreenY -= 8;

			if(self->screenY == (128 + 22))
				self->routine = Routine_Animate;

			DisplaySprite(self);
			break;

		case Routine_Animate:
			AnimateSprite(self, Ani_TitleSonic);
			DisplaySprite(self);
			break;
	}
}